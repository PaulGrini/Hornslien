Process 
=============

Experiment:

Twelve genes were selected to include MEG, PEG, and BEG examples.
For each gene, SNPs were discovered by comparing the pilon P4 consensus sequences.
SNPs were discovered using nucmer and show-snps from the MUMmer package.
For each SNP, the 21bp region was extracted in forward and reverse complement.
These results are in the parsed_SNPs.txt file

The make_script.sh script parsed the SNPs and generated the count_SNPs.sh script.
The following counts were generated with the count_SNPs.sh script on Abel.
Using each 21bp sequence, reads were searched with grep to count exact match.
The search was performed with Abel on UiO sequence files representing Cross.Replicate.Read.
Nearly all matches involved our 21bp reverse sequence to R2 or our 21bp forward sequence to R1.
These coverage counts are in the SNP.Col_x_Ler.csv (and SNP.Ler_x_Col) files.
In these files, Col comes before Ler.

The from_SNP_to_read_counts.sh script invokes the from_SNP_to_read_counts.pl script.
This script converted the csv files to the three_reps_per_gene format used for Informative Reads.
The results are in the SNP.Col_x_Ler.three_reps_per_gene (and SNP.Ler_x_Col) files.
In these files, maternal values have been cut in half.
In these files, maternal comes before paternal.
These outputs are designed for comparison to outputs of collate_three_reps_per_gene.sh for IR.
The from_SNP_to_read_counts.log file has the log for how each gene was computed.

For Informative Reads, it was necessary to run the apply_filter_to_counts.sh script.
That generated the three_reps_per_gene.filtered files with fewer than 1011 genes per cross.
For this experiment, it is not necessary to filter the genes. We have 12 genes, period.

Next, we ran the comparative_12gene_counts.sh script.
This implemented the run_differential_expression.sh script that was applied to informative reads.
This also implemented the finalize_csv.csh script that was applied to informative reads.
The run_* script was a wrapper to send each cross through the limma statistics.
Our comparative script runs the limma R script, limma.foldchange.r, from the core directory.
The R script says it expects "gene Col Col Col other other other"
but actually it was always run with "gene Mat Mat Mat Pat Pat Pat".
The comparative script runs the R script on the Informative Reads and SNP data.
The Informative Reads data is in IR.Col_x_Ler.three_reps_per_gene (and Ler_x_Col).
These files correspond to the first 7 columns of Col_x_Ler.three_reps_per_gene.filtered.final.csv (and Ler_x_Col)
from the project1/results1/Statistics directory.
The output files *.de are sorted by most to least significant.

Files
=============

parsed_SNPs.txt 
--------------------

Columns:

Gene Genotype Gene.SNP_ID position SNP 21bpFwd 21bpRev

Sample data:

AT1G02790 COL AT1G02790.SNP1 82 . CAAAAAAAAAATAAAGATAT ATATCTTTATTTTTTTTTTG
AT1G02790 LER AT1G02790.SNP1 83 A CAAAAAAAAAAATAAAGATAT ATATCTTTATTTTTTTTTTTG
AT1G02790 COL AT1G02790.SNP2 1011 G CATGGGGTGGGTCAGACCCAA TTGGGTCTGACCCACCCCATG
AT1G02790 LER AT1G02790.SNP2 1012 T CATGGGGTGGTTCAGACCCAA TTGGGTCTGAACCACCCCATG

count_SNP.Col_x_Ler.log, count_SNP.Ler_x_Col.log
------------------------------------------------

Read coverage per SNP obtained by grep using count_SNP.sh

Col_x_Ler.csv, Ler_x_Col.csv
----------------------------

Read coverage per SNP, one line per SNP, obtained using log_to_csv.sh

Columns:

SNP_ID,
COL-Fwd-R1-BR1,COL-Fwd-R1-BR2,COL-Fwd-R1-BR3,
COL-Fwd-R2-BR1,COL-Fwd-R2-BR2,COL-Fwd-R2-BR3,
COL-Rev-R1-BR1,COL-Rev-R1-BR2,COL-Rev-R1-BR3,
COL-Rev-R1-BR2,COL-Rev-R2-BR2,COL-Rev-R2-BR3,
LER-Fwd-R1-BR1,LER-Fwd-R1-BR2,LER-Fwd-R1-BR3,
LER-Fwd-R2-BR1,LER-Fwd-R2-BR2,LER-Fwd-R2-BR3,
LER-Rev-R1-BR1,LER-Rev-R1-BR2,LER-Rev-R1-BR3,
LER-Rev-R1-BR2,LER-Rev-R2-BR2,LER-Rev-R2-BR3,

Sample data:

AT1G55560.SNP1393,9,0,0,24,11,2,7,2,1,11,5,15,0,0,0,24,28,36,1,1,0,0,1,2
AT1G55560.SNP1394,19,13,7,316,128,360,409,137,238,11,3,7,48,10,18,513,526,894,639,376,667,44,4,16
AT1G55560.SNP1395,20,10,14,354,154,204,368,129,256,10,10,14,33,17,60,403,340,545,417,495,485,47,19,58


Col_x_Ler.three_reps_per_gene, Ler_x_Col.three_reps_per_gene
------------------------------------------------------------

Six values of read coverage per gene, taken from one representative SNP per gene. 

Generated from Col_x_Ler.csv, Ler_x_Col.csv

Generated by running from_SNP_to_read_counts.sh which runs from_SNP_to_read_counts.pl

Sample data:

AT1G55560 361 142 230 436 357 605
AT1G65300 3001 2637 2736 1301 1214 1289

Comparison
==========

For 12 genes, run max-min-SNP-count through limma as well is IR counts for same genes.

Generate i.e. Col_x_Ler.three_reps_per_gene.filtered.final.csv for 12 genes using max min SNP count.

Generate IR csv files i.e. twelve_genes.Col_x_Ler.three_reps_per_gene.filtered.final.csv

Compare in Excel. CORREL(FC) is 0.77 (but the stats do not correlate).

In Excel, the one outlier by FC is AT2G35670. 
Interestingly, this gene has 3 alignments to self.
Also, the SNP count at one SNP gives counts almost as high as the IR count.



