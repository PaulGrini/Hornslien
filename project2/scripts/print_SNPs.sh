#!/bin/sh 

FLANK=10
let REGION="2*${FLANK}+1"

function extract () {
    AWK="{print \"${COL_GENE} COL ${SNP_ID} ${COL_SNP} \" substr(\$1,${COL_SNP},1), substr(\$1, ${COL_SNP}-${FLANK}, ${REGION});}"
    grep -A 1 ${COL_GENE} ${COL_FASTA} | tail -1 | awk "${AWK}"
    AWK="{print \"${LER_GENE} LER ${SNP_ID} ${LER_SNP} \" substr(\$1,${LER_SNP},1), substr(\$1, ${LER_SNP}-${FLANK}, ${REGION});}"
    grep -A 1 ${LER_GENE} ${LER_FASTA} | tail -1 | awk "${AWK}"
}
function extract_special1 () {
    # For Col only, take the region upstream of the SNP
    AWK="{print \"${COL_GENE} COL ${SNP_ID} ${COL_SNP} \" substr(\$1,${COL_SNP},1), substr(\$1, ${COL_SNP}-2*${FLANK}, ${REGION});}"
    grep -A 1 ${COL_GENE} ${COL_FASTA} | tail -1 | awk "${AWK}"
    AWK="{print \"${LER_GENE} LER ${SNP_ID} ${LER_SNP} \" substr(\$1,${LER_SNP},1), substr(\$1, ${LER_SNP}-${FLANK}, ${REGION});}"
    grep -A 1 ${LER_GENE} ${LER_FASTA} | tail -1 | awk "${AWK}"
}

COL_FASTA=AT2G35670.1_Col-0.cdna_tair_7.fasta
LER_FASTA=AT2G35670.1_Ler-1.cdna_tair_7.fasta

COL_GENE=AT2G35670
LER_GENE=AT2G35670
#
SNP_ID=AT2G35670.GABI1
COL_SNP=1331
LER_SNP=1331 
#extract
SNP_ID=AT2G35670.GABI2
COL_SNP=1846
LER_SNP=1846
#extract
SNP_ID=AT2G35670.GABI3
COL_SNP=2007
LER_SNP=2007
#extract

COL_FASTA=Col.pilon4.oneline
LER_FASTA=Ler.pilon4.oneline

COL_GENE=AT2G35670
LER_GENE=AT2G35670
#
SNP_ID=AT2G35670.SNP1
COL_SNP=1331
LER_SNP=1328
extract 
SNP_ID=AT2G35670.SNP2  # THIS IS IN A LER REPEAT?
COL_SNP=1846
LER_SNP=2023
extract 
SNP_ID=AT2G35670.SNP3
COL_SNP=2007
LER_SNP=2184
extract 
SNP_ID=AT2G35670.SNP4
COL_SNP=2545
LER_SNP=2722
extract 

COL_GENE=AT5G60440
LER_GENE=AT5G60440
#
SNP_ID=AT5G60440.SNP4
COL_SNP=579
LER_SNP=579
extract
SNP_ID=AT5G60440.SNP5
COL_SNP=698
LER_SNP=698
extract
SNP_ID=AT5G60440.SNP6
COL_SNP=721
LER_SNP=721
extract

COL_GENE=AT4G25530
LER_GENE=AT4G25530
#
SNP_ID=AT4G25530.SNP1
COL_SNP=136
LER_SNP=136
extract
SNP_ID=AT4G25530.SNP2
COL_SNP=148
LER_SNP=148
extract
SNP_ID=AT4G25530.SNP3
COL_SNP=693
LER_SNP=693
extract
SNP_ID=AT4G25530.SNP4
COL_SNP=1117
LER_SNP=1117
extract

COL_GENE=AT1G02580
LER_GENE=AT1G02580
# NO SNPS

COL_GENE=AT1G65330
LER_GENE=AT1G65330
# AT1G65330 has 20 extra bases ACTGATGTTTGTGCTCCTAACATCATCAATGATCTCTAG TCGAAGGGATGTATTTCTAG
SNP_ID=AT1G65330.SNP1
COL_SNP=840
LER_SNP=840
extract_special1

COL_GENE=AT3G19350
LER_GENE=AT3G19350
#
SNP_ID=AT3G19350.SNP1
COL_SNP=356
LER_SNP=356
extract
# In long in polyA, Ler has 2bp DEL. 
SNP_ID=AT3G19350.SNP2
COL_SNP=474
LER_SNP=474
extract

COL_GENE=AT5G26650
LER_GENE=AT5G26650
# AT5G26650 has first 657 bp with 96% ident to AT5G27960.
# Ignore SNPs near base 60 and 650.
SNP_ID=AT5G26650.SNP1
COL_SNP=892
LER_SNP=892
extract
SNP_ID=AT5G26650.SNP2
COL_SNP=1119
LER_SNP=1119
extract

COL_GENE=AT2G17690
LER_GENE=AT2G17690
SNP_ID=AT2G17690.SNP1
COL_SNP=58
LER_SNP=58
extract
SNP_ID=AT2G17690.SNP2
COL_SNP=85
LER_SNP=85
extract
SNP_ID=AT2G17690.SNP3
COL_SNP=531
LER_SNP=531
extract
SNP_ID=AT2G17690.SNP4
COL_SNP=885
LER_SNP=885
extract
SNP_ID=AT2G17690.SNP5
COL_SNP=1035
LER_SNP=1035
extract
SNP_ID=AT2G17690.SNP6
COL_SNP=1209
LER_SNP=1209
extract
SNP_ID=AT2G17690.SNP7
COL_SNP=1228
LER_SNP=1228
extract
SNP_ID=AT2G17690.SNP8
COL_SNP=1297
LER_SNP=1297
extract
SNP_ID=AT2G17690.SNP9
COL_SNP=1312
LER_SNP=1312
extract
